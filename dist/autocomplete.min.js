var AutoComplete=function(){var s=function(e){this.htmlElement=e;this.loadSuggestionList=true;var t=this;this.htmlElement.addEventListener("keyup",function(e){t.loadSuggestionList=selectItemFromSuggestionList(e)})};s.prototype={loadConfiguration:function(){var e=this.htmlElement.dataset["autocomplete"];if(e===false)return false;var t=this.htmlElement.dataset["autocompletePostvarName"];var o="text";var r=!isEmpty(t)?t:o;var n=this.htmlElement.value;var a=3;var l=this.htmlElement.dataset["autocomplete-minlength"];var s=!isEmpty(l)?l:a;var i=this.htmlElement.dataset["autocompleteSource"];if(isEmpty(i)){console.log("ERROR autocomplete-source is a required data attribute");return}var u={};u[r]=n;var c={data:u,source:i,minLength:s,text:n};return c},getSuggestionList:function(){if(!this.loadSuggestionList){this.loadSuggestionList=true;return}var o=this.loadConfiguration();if(o.text.length>=o.minLength){var r=this;createHttpRequest(o.source,"POST",o.data,function(e){if(e.length>0){var t=r.createDropDown();r.populateDropDown(t,e,o.text)}else{r.removeDropDown()}},function(e){console.log(e);alert("ERROR autocomplete.js")})}else{this.removeDropDown()}},createDropDown:function(){var e=this.htmlElement.parentNode.querySelector(".autocomplete.dropdown");if(isEmpty(e)){var t=document.createElement("div");t.setAttribute("tabindex","0");t.setAttribute("class","autocomplete dropdown");t.innerHTML="<ul></ul>";this.htmlElement.parentNode.appendChild(t);e=this.htmlElement.parentNode.querySelector(".autocomplete.dropdown")}e.querySelector("ul").innerHTML="";var o={left:this.htmlElement.offsetLeft,top:this.htmlElement.offsetTop};var r=this.htmlElement.offsetHeight;var n=this.htmlElement.offsetWidth;e.style.width=n+"px";e.style.left=o.left;e.style.top=r+o.top+"px";return e},populateDropDown:function(e,t,o){var r="";for(var n=0;n<t.length;n++){var a=t[n];var l=a.toLowerCase().indexOf(o.toLowerCase());var s=l+o.length;var i=a.slice(0,l)+"<b>"+a.slice(l,s)+"</b>"+a.slice(s,a.length);r+='<li class="" data-value="'+a+'" tabindex="1">'+i+"</li>"}e.querySelector("ul").innerHTML+=r;var u=this.htmlElement;var c=e.querySelectorAll("ul li");for(var n=0;n<c.length;n++){c[n].onclick=function(){var e=this.dataset["value"];u.value=e};c[n].onmouseover=function(e){var t=e.target;var o=document.querySelectorAll(".autocomplete.dropdown ul li.selected");if(o!=null&&o!=undefined){for(var r=0;r<o.length;r++){var n=o[r];n.className=n.className.replace("selected","")}}if(t.tagName.toLowerCase()=="li")t.className+=" selected";else t.parentNode.className+=" selected"};c[n].onmouseout=function(){var e=document.querySelectorAll(".autocomplete.dropdown ul li.selected");if(e!=null&&e!=undefined){for(var t=0;t<e.length;t++){var o=e[t];o.className=o.className.replace("selected","")}}}}},removeDropDown:function(){var e=this.htmlElement.parentNode;var t=e.querySelector(".autocomplete.dropdown");if(!isEmpty(t))e.removeChild(t)},preventSuggestionListToLoad:function(){this.loadSuggestionList=false}};function selectItemFromSuggestionList(e){var t=e.key|e.keyCode;var o=e.target.parentNode.querySelectorAll(".autocomplete.dropdown ul li");var r=e.target.parentNode.querySelector(".autocomplete.dropdown ul li.selected");var n=function(e,t){for(var o=0;o<e.length;o++){if(e[o]===t){return o}}return-1};var a=function(e,t,o){var r=e[t];var n=e[o];if(r)r.className=r.className.replace("selected","");if(n)n.className+=" selected"};if(isArrowDown(t)){var l=n(o,r);a(o,l,l+1);return false}else if(isArrowUp(t)){var l=n(o,r);a(o,l,l-1);s.prototype.preventSuggestionListToLoad();return false}else if(isEnter(t)){r.click();s.prototype.preventSuggestionListToLoad();return false}else return true}function isEmpty(e){return e===null||e===undefined||e==""}function isArrowDown(e){return e==="ArrowDown"||e===40}function isArrowUp(e){return e==="ArrowUp"||e===38}function isEnter(e){return e==="Enter"||e===13}function createHttpRequest(e,t,o,r,n){httpRequest=new XMLHttpRequest;httpRequest.open(t.toUpperCase(),e);httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=function(e){var t=[];for(var o in e)if(e.hasOwnProperty(o)){t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]))}return t.join("&")}(o);httpRequest.onreadystatechange=function(){if(httpRequest.readyState===XMLHttpRequest.DONE){var e=JSON.parse(httpRequest.responseText);if(httpRequest.status===200){r(e)}else{n(e)}}};httpRequest.send(a)}return s}();window.addEventListener("click",function(e){var t=document.querySelectorAll(".autocomplete.dropdown");for(var o=0;o<t.length;o++){t[o].parentNode.removeChild(t[o])}});