var AutoComplete=function(){var e=function(e){this.element=e};function i(e){return null==e||""==e}return e.prototype={loadConfiguration:function(){if(!1===this.element.dataset.autocomplete)return!1;var e=this.element.dataset.autocompletePostvarName,t=i(e)?"text":e,o=this.element.value,n=this.element.dataset["autocomplete-minlength"],r=i(n)?3:n,a=this.element.dataset.autocompleteSource;if(!i(a)){var l={};return l[t]=o,{data:l,source:a,minLength:r,text:o}}console.log("ERROR autocomplete-source is a required data attribute")},getSuggestionList:function(){var o=this.loadConfiguration();if(o.text.length>=o.minLength){var n=this;!function(e,t,o,n,r){httpRequest=new XMLHttpRequest,httpRequest.open(t.toUpperCase(),e),httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")}(o);httpRequest.onreadystatechange=function(){if(httpRequest.readyState===XMLHttpRequest.DONE){var e=JSON.parse(httpRequest.responseText);200===httpRequest.status?n(e):r(e)}},httpRequest.send(a)}(o.source,"POST",o.data,function(e){if(0<e.length){var t=n.createDropDown();n.populateDropDown(t,e,o.text)}else n.removeDropDown()},function(e){console.log(e),alert("ERROR autocomplete.js")})}else this.removeDropDown()},createDropDown:function(){var e=this.element.parentNode.querySelector(".autocomplete.dropdown");if(i(e)){var t=document.createElement("div");t.setAttribute("tabindex","0"),t.setAttribute("class","autocomplete dropdown"),t.innerHTML="<ul></ul>",this.element.parentNode.appendChild(t),e=this.element.parentNode.querySelector(".autocomplete.dropdown")}e.querySelector("ul").innerHTML="";var o={left:this.element.offsetLeft,top:this.element.offsetTop},n=this.element.offsetHeight,r=this.element.offsetWidth;return e.style.width=r+"px",e.style.left=o.left,e.style.top=n+o.top+"px",e},populateDropDown:function(e,t,o){for(var n="",r=0;r<t.length;r++){var a=t[r],l=a.toLowerCase().indexOf(o.toLowerCase()),i=l+o.length,u=a.slice(0,l)+"<b>"+a.slice(l,i)+"</b>"+a.slice(i,a.length);n+='<li data-value="'+a+'" tabindex="1">'+u+"</li>"}e.querySelector("ul").innerHTML+=n;var s=this.element,p=e.querySelectorAll("ul li");for(r=0;r<p.length;r++)p[r].onclick=function(){var e=this.dataset.value;s.value=e}},removeDropDown:function(){var e=this.element.parentNode,t=e.querySelector(".autocomplete.dropdown");i(t)||e.removeChild(t)}},e}();window.addEventListener("click",function(e){for(var t=document.querySelectorAll(".autocomplete.dropdown"),o=0;o<t.length;o++)t[o].parentNode.removeChild(t[o])});